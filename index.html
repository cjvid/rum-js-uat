<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Datadog RUM Demo - Login</title>

  <!-- Datadog RUM -->
  <script src="https://www.datadoghq-browser-agent.com/us1/v6/datadog-rum.js" crossorigin="anonymous"></script>
  <script>
    window.DD_RUM && window.DD_RUM.init({
      clientToken: 'pub3a9242d3cff288df4f25082fefa8e4e7',
      applicationId: '93b458ba-4215-49d4-89cd-41f946ce2c1d',
      site: 'datadoghq.com',
      service: 'rum-test-site',
      env: 'uat',
      sessionSampleRate: 100,
      sessionReplaySampleRate: 100,
      trackUserInteractions: true,
      trackResources: true,
      trackLongTasks: true,
      defaultPrivacyLevel: 'mask-user-input',
      version: '1.0.0'
    });

    // Start session replay recording immediately
    window.DD_RUM && window.DD_RUM.startSessionReplayRecording();
  </script>

  <link rel="stylesheet" href="styles.css" />
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    .login-container { max-width: 400px; margin: auto; border: 1px solid #ccc; padding: 2rem; border-radius: 8px; }
    input { width: 100%; padding: 0.5rem; margin-bottom: 1rem; }
    button { padding: 0.5rem 1rem; }
  </style>
</head>
<body>

  <div class="login-container">
    <h2>Login for RUM Test</h2>

    <input type="text" id="username" placeholder="Enter username" />
    <input type="email" id="email" placeholder="Enter email" />
    <select id="plan">
      <option value="free">Free</option>
      <option value="premium">Premium</option>
      <option value="enterprise">Enterprise</option>
    </select>
    <br/>
    <button onclick="loginUser()">Login</button>

    <p id="status"></p>
  </div>

  <script>
    function loginUser() {
      const username = document.getElementById("username").value;
      const email = document.getElementById("email").value;
      const plan = document.getElementById("plan").value;

      if (!username || !email) {
        alert("Please fill out all fields");
        return;
      }

      // Simulate a user ID (in real app, use backend auth ID)
      const userId = 'user-' + Math.floor(Math.random() * 100000);

      // Set user in Datadog RUM
      window.DD_RUM && window.DD_RUM.setUser({
        id: userId,
        name: username,
        email: email,
        plan: plan
      });

      document.getElementById("status").innerText = 
        `User "${username}" logged in for RUM testing.`;
      
      console.log("RUM user set:", { id: userId, name: username, email, plan });
    }
  </script>

</body>
</html>
